<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whankoos POS Pro - Historial de Ventas</title>
    <link rel="stylesheet" href="../css/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fwhankoosp1201back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-card border-b border-border">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary-500 to-secondary-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-pizza-slice text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-text-primary">Whankoos POS Pro</h1>
                        <p class="text-sm text-text-secondary">Historial de Ventas</p>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-4">
                    <a href="main_pos_dashboard.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-home mr-2"></i>Dashboard
                    </a>
                    <a href="exchange_rate_management.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-exchange-alt mr-2"></i>Tasas
                    </a>
                    <a href="sales_history_analytics.html" class="px-4 py-2 bg-primary-500 text-white rounded-button font-medium">
                        <i class="fas fa-chart-line mr-2"></i>Ventas
                    </a>
                    <a href="table_zone_management.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-table mr-2"></i>Mesas
                    </a>
                    <a href="order_cart_management.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-shopping-cart mr-2"></i>Pedidos
                    </a>
                </nav>

                <!-- Mobile Menu Button -->
                <button class="md:hidden p-2 text-text-secondary hover:text-primary-500" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-border">
            <div class="px-4 py-2 space-y-2">
                <a href="main_pos_dashboard.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-home mr-2"></i>Dashboard Principal
                </a>
                <a href="exchange_rate_management.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-exchange-alt mr-2"></i>Tasas de Cambio
                </a>
                <a href="sales_history_analytics.html" class="block px-4 py-2 bg-primary-500 text-white rounded-button font-medium">
                    <i class="fas fa-chart-line mr-2"></i>Historial de Ventas
                </a>
                <a href="table_zone_management.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-table mr-2"></i>Gestión de Mesas
                </a>
                <a href="order_cart_management.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-shopping-cart mr-2"></i>Gestión de Pedidos
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 p-4 lg:p-6">
        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <!-- Daily Total Card -->
            <div class="bg-white shadow-card border border-border rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary">Total del Día</p>
                        <p class="text-2xl font-bold text-text-primary text-data">$<span id="dailyTotal">247.50</span></p>
                        <p class="text-sm text-text-secondary">Bs <span id="dailyTotalBs" class="text-data">11,261.25</span></p>
                    </div>
                    <div class="w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-dollar-sign text-success-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Average Order Value Card -->
            <div class="bg-white shadow-card border border-border rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary">Promedio por Orden</p>
                        <p class="text-2xl font-bold text-text-primary text-data">$<span id="avgOrder">20.63</span></p>
                        <p class="text-sm text-text-secondary">12 transacciones</p>
                    </div>
                    <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-chart-bar text-accent-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Popular Item Card -->
            <div class="bg-white shadow-card border border-border rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-text-secondary">Producto Más Vendido</p>
                        <p class="text-lg font-semibold text-text-primary">Whankoos 440</p>
                        <p class="text-sm text-text-secondary">8 unidades vendidas</p>
                    </div>
                    <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-pizza-slice text-primary-600 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Actions -->
        <div class="bg-white shadow-card border border-border rounded-lg p-4 mb-6">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
                <!-- Filters -->
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                    <!-- Date Range Filter -->
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-text-primary">Fecha:</label>
                        <input type="date" id="startDate" class="px-3 py-2 border border-border rounded-button text-sm focus:outline-none focus:ring-2 focus:ring-primary-500" value="2025-10-22">
                        <span class="text-text-secondary">-</span>
                        <input type="date" id="endDate" class="px-3 py-2 border border-border rounded-button text-sm focus:outline-none focus:ring-2 focus:ring-primary-500" value="2025-10-22">
                    </div>

                    <!-- Zone Filter -->
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-text-primary">Zona:</label>
                        <select id="zoneFilter" class="px-3 py-2 border border-border rounded-button text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="all">Todas las Zonas</option>
                            <option value="terraza">Terraza</option>
                            <option value="piso1">Piso 1</option>
                            <option value="piso2">Piso 2</option>
                        </select>
                    </div>

                    <!-- Amount Sort -->
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-text-primary">Ordenar:</label>
                        <select id="sortOrder" class="px-3 py-2 border border-border rounded-button text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="newest">Más Reciente</option>
                            <option value="oldest">Más Antiguo</option>
                            <option value="highest">Mayor Monto</option>
                            <option value="lowest">Menor Monto</option>
                        </select>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex space-x-3">
                    <!-- Search -->
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Buscar por mesa o monto..." class="pl-10 pr-4 py-2 border border-border rounded-button text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 w-64">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary"></i>
                    </div>

                    <!-- Export CSV -->
                    <button onclick="exportCSV()" class="bg-primary-500 text-white px-4 py-2 rounded-button text-sm font-medium hover:bg-primary-600 transition-micro">
                        <i class="fas fa-download mr-2"></i>Exportar CSV
                    </button>

                    <!-- Print Report -->
                    <button onclick="printReport()" class="border border-border text-text-primary px-4 py-2 rounded-button text-sm font-medium hover:bg-gray-50 transition-micro">
                        <i class="fas fa-print mr-2"></i>Imprimir
                    </button>
                </div>
            </div>
        </div>

        <!-- Transactions List -->
        <div class="bg-white shadow-card border border-border rounded-lg">
            <!-- Table Header -->
            <div class="px-6 py-4 border-b border-border">
                <h2 class="text-lg font-semibold text-text-primary">Últimas 12 Transacciones</h2>
            </div>

            <!-- Desktop Table View -->
            <div class="hidden lg:block overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50 border-b border-border">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Fecha/Hora</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Mesa</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Productos</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Total USD</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Total Bs</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Estado</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsTable" class="bg-white divide-y divide-border">
                        <!-- Transactions will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div class="lg:hidden" id="transactionCards">
                <!-- Transaction cards will be populated here -->
            </div>
        </div>
    </main>

    <!-- Transaction Detail Modal -->
    <div id="transactionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg w-full max-w-2xl mx-4 shadow-floating max-h-screen overflow-y-auto">
            <div class="flex items-center justify-between p-6 border-b border-border">
                <h3 class="text-lg font-semibold text-text-primary">Detalle de Transacción</h3>
                <button onclick="closeTransactionModal()" class="text-text-secondary hover:text-text-primary transition-micro">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="p-6" id="transactionDetails">
                <!-- Transaction details will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Sample transaction data
        const transactions = [
            {
                id: 'TXN-001',
                date: '2025-10-22',
                time: '14:35',
                table: 'T1',
                zone: 'terraza',
                items: [
                    { name: 'Whankoos 440', size: 'M', quantity: 2, price: 12.00 },
                    { name: 'Coca Cola', size: '', quantity: 2, price: 2.50 }
                ],
                totalUSD: 29.00,
                totalBs: 1319.50,
                totalCOP: 123250,
                status: 'Pagado',
                paymentMethod: 'Efectivo USD'
            },
            {
                id: 'TXN-002',
                date: '2025-10-22',
                time: '14:20',
                table: 'P1-2',
                zone: 'piso1',
                items: [
                    { name: 'Pepperoni', size: 'G', quantity: 1, price: 14.50 },
                    { name: 'Hawaiana', size: 'P', quantity: 1, price: 8.00 },
                    { name: 'Agua', size: '', quantity: 2, price: 1.50 }
                ],
                totalUSD: 25.50,
                totalBs: 1160.25,
                totalCOP: 108375,
                status: 'Pagado',
                paymentMethod: 'Bolívares'
            },
            {
                id: 'TXN-003',
                date: '2025-10-22',
                time: '14:05',
                table: 'P2-3',
                zone: 'piso2',
                items: [
                    { name: 'Chicken Cream', size: 'G', quantity: 1, price: 16.50 },
                    { name: 'Jugo Naranja', size: '', quantity: 1, price: 3.00 }
                ],
                totalUSD: 19.50,
                totalBs: 887.25,
                totalCOP: 82875,
                status: 'Pagado',
                paymentMethod: 'Pesos COP'
            },
            {
                id: 'TXN-004',
                date: '2025-10-22',
                time: '13:45',
                table: 'T3',
                zone: 'terraza',
                items: [
                    { name: 'Whankoos 440', size: 'P', quantity: 3, price: 8.50 },
                    { name: 'Gyro', size: '', quantity: 1, price: 6.50 }
                ],
                totalUSD: 32.00,
                totalBs: 1456.00,
                totalCOP: 136000,
                status: 'Pagado',
                paymentMethod: 'Efectivo USD'
            },
            {
                id: 'TXN-005',
                date: '2025-10-22',
                time: '13:30',
                table: 'P1-4',
                zone: 'piso1',
                items: [
                    { name: 'Whankoos 440', size: 'M', quantity: 1, price: 12.00 },
                    { name: 'Whankidog', size: '', quantity: 2, price: 4.50 }
                ],
                totalUSD: 21.00,
                totalBs: 955.50,
                totalCOP: 89250,
                status: 'Pagado',
                paymentMethod: 'Bolívares'
            },
            {
                id: 'TXN-006',
                date: '2025-10-22',
                time: '13:15',
                table: 'T2',
                zone: 'terraza',
                items: [
                    { name: 'Pepperoni', size: 'M', quantity: 1, price: 11.00 },
                    { name: 'Coca Cola', size: '', quantity: 1, price: 2.50 }
                ],
                totalUSD: 13.50,
                totalBs: 614.25,
                totalCOP: 57375,
                status: 'Pagado',
                paymentMethod: 'Efectivo USD'
            },
            {
                id: 'TXN-007',
                date: '2025-10-22',
                time: '12:50',
                table: 'P2-1',
                zone: 'piso2',
                items: [
                    { name: 'Hawaiana', size: 'G', quantity: 1, price: 15.00 },
                    { name: 'Agua', size: '', quantity: 2, price: 1.50 }
                ],
                totalUSD: 18.00,
                totalBs: 819.00,
                totalCOP: 76500,
                status: 'Pagado',
                paymentMethod: 'Pesos COP'
            },
            {
                id: 'TXN-008',
                date: '2025-10-22',
                time: '12:35',
                table: 'P1-1',
                zone: 'piso1',
                items: [
                    { name: 'Whankoos 440', size: 'G', quantity: 1, price: 15.50 },
                    { name: 'Jugo Naranja', size: '', quantity: 1, price: 3.00 }
                ],
                totalUSD: 18.50,
                totalBs: 841.75,
                totalCOP: 78625,
                status: 'Pagado',
                paymentMethod: 'Bolívares'
            },
            {
                id: 'TXN-009',
                date: '2025-10-22',
                time: '12:20',
                table: 'T4',
                zone: 'terraza',
                items: [
                    { name: 'Chicken Cream', size: 'M', quantity: 1, price: 13.00 },
                    { name: 'Coca Cola', size: '', quantity: 2, price: 2.50 }
                ],
                totalUSD: 18.00,
                totalBs: 819.00,
                totalCOP: 76500,
                status: 'Pagado',
                paymentMethod: 'Efectivo USD'
            },
            {
                id: 'TXN-010',
                date: '2025-10-22',
                time: '12:05',
                table: 'P2-4',
                zone: 'piso2',
                items: [
                    { name: 'Pepperoni', size: 'P', quantity: 2, price: 7.50 },
                    { name: 'Gyro', size: '', quantity: 1, price: 6.50 }
                ],
                totalUSD: 21.50,
                totalBs: 978.25,
                totalCOP: 91375,
                status: 'Pagado',
                paymentMethod: 'Pesos COP'
            },
            {
                id: 'TXN-011',
                date: '2025-10-22',
                time: '11:45',
                table: 'P1-3',
                zone: 'piso1',
                items: [
                    { name: 'Hawaiana', size: 'M', quantity: 1, price: 11.50 },
                    { name: 'Whankidog', size: '', quantity: 1, price: 4.50 },
                    { name: 'Agua', size: '', quantity: 1, price: 1.50 }
                ],
                totalUSD: 17.50,
                totalBs: 796.25,
                totalCOP: 74375,
                status: 'Pagado',
                paymentMethod: 'Bolívares'
            },
            {
                id: 'TXN-012',
                date: '2025-10-22',
                time: '11:30',
                table: 'P2-2',
                zone: 'piso2',
                items: [
                    { name: 'Whankoos 440', size: 'P', quantity: 1, price: 8.50 },
                    { name: 'Chicken Cream', size: 'P', quantity: 1, price: 9.00 },
                    { name: 'Jugo Naranja', size: '', quantity: 2, price: 3.00 }
                ],
                totalUSD: 23.50,
                totalBs: 1069.25,
                totalCOP: 99875,
                status: 'Pagado',
                paymentMethod: 'Efectivo USD'
            }
        ];

        let filteredTransactions = [...transactions];

        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            renderTransactions();
            updateSummaryCards();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('startDate').addEventListener('change', filterTransactions);
            document.getElementById('endDate').addEventListener('change', filterTransactions);
            document.getElementById('zoneFilter').addEventListener('change', filterTransactions);
            document.getElementById('sortOrder').addEventListener('change', filterTransactions);
            document.getElementById('searchInput').addEventListener('input', filterTransactions);
        }

        // Filter transactions
        function filterTransactions() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const zone = document.getElementById('zoneFilter').value;
            const sortOrder = document.getElementById('sortOrder').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            filteredTransactions = transactions.filter(transaction => {
                // Date filter
                if (startDate && transaction.date < startDate) return false;
                if (endDate && transaction.date > endDate) return false;
                
                // Zone filter
                if (zone !== 'all' && transaction.zone !== zone) return false;
                
                // Search filter
                if (searchTerm && !transaction.table.toLowerCase().includes(searchTerm) && 
                    !transaction.totalUSD.toString().includes(searchTerm)) return false;
                
                return true;
            });

            // Sort transactions
            filteredTransactions.sort((a, b) => {
                switch (sortOrder) {
                    case 'newest':
                        return new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time);
                    case 'oldest':
                        return new Date(a.date + ' ' + a.time) - new Date(b.date + ' ' + b.time);
                    case 'highest':
                        return b.totalUSD - a.totalUSD;
                    case 'lowest':
                        return a.totalUSD - b.totalUSD;
                    default:
                        return 0;
                }
            });

            renderTransactions();
        }

        // Render transactions
        function renderTransactions() {
            renderDesktopTable();
            renderMobileCards();
        }

        // Render desktop table
        function renderDesktopTable() {
            const tableBody = document.getElementById('transactionsTable');
            
            tableBody.innerHTML = filteredTransactions.map(transaction => `
                <tr class="hover:bg-gray-50 transition-micro">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-text-primary">${formatDate(transaction.date)}</div>
                        <div class="text-sm text-text-secondary">${transaction.time}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-accent-100 text-accent-800">
                            ${transaction.table}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-text-primary">
                            ${transaction.items.slice(0, 2).map(item => 
                                `${item.name}${item.size ? ` (${item.size})` : ''} x${item.quantity}`
                            ).join(', ')}
                            ${transaction.items.length > 2 ? `... +${transaction.items.length - 2} más` : ''}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-data text-text-primary">$${transaction.totalUSD.toFixed(2)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-data text-text-secondary">Bs ${transaction.totalBs.toFixed(2)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">
                            ${transaction.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewTransactionDetails('${transaction.id}')" class="text-primary-600 hover:text-primary-900 transition-micro">
                            <i class="fas fa-eye mr-1"></i>Ver
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Render mobile cards
        function renderMobileCards() {
            const cardsContainer = document.getElementById('transactionCards');
            
            cardsContainer.innerHTML = filteredTransactions.map(transaction => `
                <div class="p-4 border-b border-border last:border-b-0">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-accent-100 text-accent-800">
                                ${transaction.table}
                            </span>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">
                                ${transaction.status}
                            </span>
                        </div>
                        <div class="text-sm text-text-secondary">${formatDate(transaction.date)} ${transaction.time}</div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="text-sm text-text-primary mb-1">
                            ${transaction.items.slice(0, 2).map(item => 
                                `${item.name}${item.size ? ` (${item.size})` : ''} x${item.quantity}`
                            ).join(', ')}
                            ${transaction.items.length > 2 ? `... +${transaction.items.length - 2} más` : ''}
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-lg font-semibold text-data text-text-primary">$${transaction.totalUSD.toFixed(2)}</div>
                            <div class="text-sm text-data text-text-secondary">Bs ${transaction.totalBs.toFixed(2)}</div>
                        </div>
                        <button onclick="viewTransactionDetails('${transaction.id}')" class="bg-primary-500 text-white px-3 py-1 rounded-button text-sm hover:bg-primary-600 transition-micro">
                            <i class="fas fa-eye mr-1"></i>Ver
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Update summary cards
        function updateSummaryCards() {
            const dailyTotal = transactions.reduce((sum, t) => sum + t.totalUSD, 0);
            const avgOrder = dailyTotal / transactions.length;
            
            document.getElementById('dailyTotal').textContent = dailyTotal.toFixed(2);
            document.getElementById('dailyTotalBs').textContent = (dailyTotal * 45.50).toFixed(2);
            document.getElementById('avgOrder').textContent = avgOrder.toFixed(2);
        }

        // View transaction details
        function viewTransactionDetails(transactionId) {
            const transaction = transactions.find(t => t.id === transactionId);
            if (!transaction) return;

            const detailsContainer = document.getElementById('transactionDetails');
            
            detailsContainer.innerHTML = `
                <div class="space-y-6">
                    <!-- Transaction Info -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">ID Transacción</label>
                            <p class="text-data font-medium">${transaction.id}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">Mesa</label>
                            <p class="font-medium">${transaction.table}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">Fecha</label>
                            <p class="font-medium">${formatDate(transaction.date)}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">Hora</label>
                            <p class="font-medium">${transaction.time}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">Estado</label>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">
                                ${transaction.status}
                            </span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-secondary">Método de Pago</label>
                            <p class="font-medium">${transaction.paymentMethod}</p>
                        </div>
                    </div>

                    <!-- Items -->
                    <div>
                        <h4 class="text-lg font-semibold text-text-primary mb-3">Productos</h4>
                        <div class="space-y-2">
                            ${transaction.items.map(item => `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <p class="font-medium">${item.name}${item.size ? ` (${item.size})` : ''}</p>
                                        <p class="text-sm text-text-secondary">Cantidad: ${item.quantity}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-medium text-data">$${(item.price * item.quantity).toFixed(2)}</p>
                                        <p class="text-sm text-text-secondary text-data">$${item.price.toFixed(2)} c/u</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Totals -->
                    <div class="border-t border-border pt-4">
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="font-medium">Total USD:</span>
                                <span class="font-bold text-data text-lg">$${transaction.totalUSD.toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between text-text-secondary">
                                <span>Total Bs:</span>
                                <span class="text-data">Bs ${transaction.totalBs.toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between text-text-secondary">
                                <span>Total COP:</span>
                                <span class="text-data">$${transaction.totalCOP.toFixed(0)}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('transactionModal').classList.remove('hidden');
            document.getElementById('transactionModal').classList.add('flex');
        }

        // Close transaction modal
        function closeTransactionModal() {
            document.getElementById('transactionModal').classList.add('hidden');
            document.getElementById('transactionModal').classList.remove('flex');
        }

        // Export CSV
        function exportCSV() {
            const headers = ['ID', 'Fecha', 'Hora', 'Mesa', 'Zona', 'Productos', 'Total USD', 'Total Bs', 'Total COP', 'Estado', 'Método Pago'];
            
            const csvData = filteredTransactions.map(transaction => [
                transaction.id,
                transaction.date,
                transaction.time,
                transaction.table,
                transaction.zone,
                transaction.items.map(item => `${item.name}${item.size ? ` (${item.size})` : ''} x${item.quantity}`).join('; '),
                transaction.totalUSD.toFixed(2),
                transaction.totalBs.toFixed(2),
                transaction.totalCOP.toFixed(0),
                transaction.status,
                transaction.paymentMethod
            ]);

            const csvContent = [headers, ...csvData]
                .map(row => row.map(field => `"${field}"`).join(','))
                .join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `whankoos_ventas_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Print report
        function printReport() {
            const printWindow = window.open('', '_blank');
            const printContent = `
                <html>
                <head>
                    <title>Reporte de Ventas - Whankoos POS Pro</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .summary { margin-bottom: 30px; }
                        .summary-card { display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f5f5f5; }
                        .total { font-weight: bold; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Whankoos POS Pro</h1>
                        <h2>Reporte de Ventas</h2>
                        <p>Fecha: ${new Date().toLocaleDateString('es-ES')}</p>
                    </div>
                    
                    <div class="summary">
                        <div class="summary-card">
                            <h3>Total del Día</h3>
                            <p class="total">$${transactions.reduce((sum, t) => sum + t.totalUSD, 0).toFixed(2)}</p>
                        </div>
                        <div class="summary-card">
                            <h3>Transacciones</h3>
                            <p class="total">${transactions.length}</p>
                        </div>
                        <div class="summary-card">
                            <h3>Promedio por Orden</h3>
                            <p class="total">$${(transactions.reduce((sum, t) => sum + t.totalUSD, 0) / transactions.length).toFixed(2)}</p>
                        </div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha/Hora</th>
                                <th>Mesa</th>
                                <th>Productos</th>
                                <th>Total USD</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredTransactions.map(transaction => `
                                <tr>
                                    <td>${formatDate(transaction.date)} ${transaction.time}</td>
                                    <td>${transaction.table}</td>
                                    <td>${transaction.items.map(item => `${item.name}${item.size ? ` (${item.size})` : ''} x${item.quantity}`).join(', ')}</td>
                                    <td>$${transaction.totalUSD.toFixed(2)}</td>
                                    <td>${transaction.status}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                <script id="dhws-dataInjector" src="../public/dhws-data-injector.js"><\/script>
</body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
    </script>
</body>
</html>
