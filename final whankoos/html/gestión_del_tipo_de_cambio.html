<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whankoos POS Pro - Gestión de Tasas de Cambio</title>
    <link rel="stylesheet" href="../css/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fwhankoosp1201back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-card border-b border-border">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary-500 to-secondary-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-pizza-slice text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-text-primary">Whankoos POS Pro</h1>
                        <p class="text-sm text-text-secondary">Gestión de Tasas de Cambio</p>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-4">
                    <a href="main_pos_dashboard.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-home mr-2"></i>Dashboard
                    </a>
                    <a href="exchange_rate_management.html" class="px-4 py-2 bg-primary-500 text-white rounded-button font-medium">
                        <i class="fas fa-exchange-alt mr-2"></i>Tasas
                    </a>
                    <a href="sales_history_analytics.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-chart-line mr-2"></i>Ventas
                    </a>
                    <a href="table_zone_management.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-table mr-2"></i>Mesas
                    </a>
                    <a href="order_cart_management.html" class="px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                        <i class="fas fa-shopping-cart mr-2"></i>Pedidos
                    </a>
                </nav>

                <!-- Mobile Menu Button -->
                <button class="md:hidden p-2 text-text-secondary hover:text-primary-500" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-border">
            <div class="px-4 py-2 space-y-2">
                <a href="main_pos_dashboard.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-home mr-2"></i>Dashboard Principal
                </a>
                <a href="exchange_rate_management.html" class="block px-4 py-2 bg-primary-500 text-white rounded-button font-medium">
                    <i class="fas fa-exchange-alt mr-2"></i>Tasas de Cambio
                </a>
                <a href="sales_history_analytics.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-chart-line mr-2"></i>Historial de Ventas
                </a>
                <a href="table_zone_management.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-table mr-2"></i>Gestión de Mesas
                </a>
                <a href="order_cart_management.html" class="block px-4 py-2 text-text-secondary hover:text-primary-500 transition-micro">
                    <i class="fas fa-shopping-cart mr-2"></i>Gestión de Pedidos
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 p-4 lg:p-8">
        <div class="max-w-6xl mx-auto">
            <!-- Page Header -->
            <div class="mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold text-text-primary mb-2">Gestión de Tasas de Cambio</h2>
                        <p class="text-text-secondary">Administra las tasas de conversión para múltiples monedas</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="text-sm text-text-secondary">
                            <i class="fas fa-clock mr-1"></i>
                            Última actualización: <span id="lastUpdate" class="text-data">22/10/2025 01:51</span>
                        </div>
                        <button onclick="resetToDefaults()" class="px-4 py-2 border border-border text-text-secondary hover:bg-gray-50 rounded-button transition-micro">
                            <i class="fas fa-undo mr-2"></i>Restablecer
                        </button>
                    </div>
                </div>
            </div>

            <!-- Current Rates Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- USD Base -->
                <div class="bg-white rounded-lg shadow-card border border-border p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-secondary-600 rounded-lg flex items-center justify-center">
                                <i class="fas fa-dollar-sign text-white text-lg"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-text-primary">Dólar USD</h3>
                                <p class="text-sm text-text-secondary">Moneda base</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-data text-primary-600">$1.00</div>
                            <div class="text-sm text-success-600">
                                <i class="fas fa-check-circle mr-1"></i>Activo
                            </div>
                        </div>
                    </div>
                    <div class="bg-primary-50 p-3 rounded-lg">
                        <p class="text-sm text-primary-700">Moneda de referencia para todas las conversiones</p>
                    </div>
                </div>

                <!-- Venezuelan Bolívars -->
                <div class="bg-white rounded-lg shadow-card border border-border p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-warning-500 to-warning-600 rounded-lg flex items-center justify-center">
                                <span class="text-white font-bold text-lg">Bs</span>
                            </div>
                            <div>
                                <h3 class="font-semibold text-text-primary">Bolívares</h3>
                                <p class="text-sm text-text-secondary">Venezuela (VES)</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-data text-warning-600" id="currentBsRate">Bs 45.50</div>
                            <div class="text-sm text-text-secondary">
                                por $1 USD
                            </div>
                        </div>
                    </div>
                    <div class="bg-warning-50 p-3 rounded-lg">
                        <p class="text-sm text-warning-700">Tasa actual de conversión USD a Bolívares</p>
                    </div>
                </div>

                <!-- Colombian Pesos -->
                <div class="bg-white rounded-lg shadow-card border border-border p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-accent-500 to-accent-600 rounded-lg flex items-center justify-center">
                                <span class="text-white font-bold text-lg">$</span>
                            </div>
                            <div>
                                <h3 class="font-semibold text-text-primary">Pesos COP</h3>
                                <p class="text-sm text-text-secondary">Colombia (COP)</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-data text-accent-600" id="currentCopRate">$4,250</div>
                            <div class="text-sm text-text-secondary">
                                por $1 USD
                            </div>
                        </div>
                    </div>
                    <div class="bg-accent-50 p-3 rounded-lg">
                        <p class="text-sm text-accent-700">Tasa actual de conversión USD a Pesos</p>
                    </div>
                </div>
            </div>

            <!-- Exchange Rate Management Form -->
            <div class="bg-white rounded-lg shadow-card border border-border">
                <div class="p-6 border-b border-border">
                    <h3 class="text-lg font-semibold text-text-primary mb-2">Actualizar Tasas de Cambio</h3>
                    <p class="text-text-secondary">Modifica las tasas de conversión para reflejar los valores actuales del mercado</p>
                </div>

                <div class="p-6">
                    <form id="exchangeRateForm" class="space-y-6">
                        <!-- Bolívares Rate -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <label for="bsRate" class="block text-sm font-medium text-text-primary mb-2">
                                    <i class="fas fa-coins text-warning-500 mr-2"></i>
                                    Bolívares por USD
                                </label>
                                <div class="relative">
                                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary">Bs</span>
                                    <input 
                                        type="number" 
                                        id="bsRate" 
                                        step="0.01" 
                                        min="0.01" 
                                        max="999999.99"
                                        value="45.50"
                                        class="w-full pl-10 pr-4 py-3 border border-border rounded-button focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-data"
                                        placeholder="0.00"
                                        oninput="validateAndPreview()"
                                    >
                                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
                                        <i id="bsValidation" class="fas fa-check-circle text-success-500 hidden"></i>
                                        <i id="bsError" class="fas fa-exclamation-circle text-error-500 hidden"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-text-secondary mt-1">Ingresa la tasa actual de Bolívares por 1 USD</p>
                            </div>

                            <div>
                                <label for="copRate" class="block text-sm font-medium text-text-primary mb-2">
                                    <i class="fas fa-coins text-accent-500 mr-2"></i>
                                    Pesos Colombianos por USD
                                </label>
                                <div class="relative">
                                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary">$</span>
                                    <input 
                                        type="number" 
                                        id="copRate" 
                                        step="1" 
                                        min="1" 
                                        max="999999"
                                        value="4250"
                                        class="w-full pl-10 pr-4 py-3 border border-border rounded-button focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-data"
                                        placeholder="0"
                                        oninput="validateAndPreview()"
                                    >
                                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
                                        <i id="copValidation" class="fas fa-check-circle text-success-500 hidden"></i>
                                        <i id="copError" class="fas fa-exclamation-circle text-error-500 hidden"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-text-secondary mt-1">Ingresa la tasa actual de Pesos por 1 USD</p>
                            </div>
                        </div>

                        <!-- Rate Sources -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-text-primary mb-3">
                                <i class="fas fa-info-circle text-accent-500 mr-2"></i>
                                Fuentes de Referencia
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p class="text-text-secondary mb-1">Bolívares (VES):</p>
                                    <ul class="space-y-1 text-text-secondary">
                                        <li>• Banco Central de Venezuela</li>
                                        <li>• DolarToday</li>
                                        <li>• Monitor Dólar</li>
                                    </ul>
                                </div>
                                <div>
                                    <p class="text-text-secondary mb-1">Pesos Colombianos (COP):</p>
                                    <ul class="space-y-1 text-text-secondary">
                                        <li>• Banco de la República</li>
                                        <li>• XE Currency</li>
                                        <li>• Yahoo Finance</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Preview Section -->
                        <div id="previewSection" class="bg-primary-50 border border-primary-200 rounded-lg p-4">
                            <h4 class="font-medium text-primary-800 mb-3">
                                <i class="fas fa-eye text-primary-600 mr-2"></i>
                                Vista Previa de Precios
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-white p-3 rounded-lg">
                                    <p class="text-sm text-text-secondary mb-1">Pizza Whankoos 440 (P)</p>
                                    <div class="space-y-1">
                                        <div class="text-data font-medium">$8.50 USD</div>
                                        <div class="text-sm text-warning-600" id="previewBs">Bs 386.75</div>
                                        <div class="text-sm text-accent-600" id="previewCop">$36,125 COP</div>
                                    </div>
                                </div>
                                <div class="bg-white p-3 rounded-lg">
                                    <p class="text-sm text-text-secondary mb-1">Coca Cola</p>
                                    <div class="space-y-1">
                                        <div class="text-data font-medium">$2.50 USD</div>
                                        <div class="text-sm text-warning-600" id="previewBsCola">Bs 113.75</div>
                                        <div class="text-sm text-accent-600" id="previewCopCola">$10,625 COP</div>
                                    </div>
                                </div>
                                <div class="bg-white p-3 rounded-lg">
                                    <p class="text-sm text-text-secondary mb-1">Gyro</p>
                                    <div class="space-y-1">
                                        <div class="text-data font-medium">$6.50 USD</div>
                                        <div class="text-sm text-warning-600" id="previewBsGyro">Bs 295.75</div>
                                        <div class="text-sm text-accent-600" id="previewCopGyro">$27,625 COP</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-border">
                            <button 
                                type="submit" 
                                id="saveButton"
                                class="flex-1 bg-primary-500 text-white py-3 px-6 rounded-button font-medium hover:bg-primary-600 transition-micro disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                <i class="fas fa-save mr-2"></i>
                                <span id="saveButtonText">Guardar Cambios</span>
                            </button>
                            <button 
                                type="button" 
                                onclick="cancelChanges()"
                                class="flex-1 sm:flex-none px-6 py-3 border border-border text-text-primary hover:bg-gray-50 rounded-button transition-micro"
                            >
                                <i class="fas fa-times mr-2"></i>Cancelar
                            </button>
                            <a 
                                href="main_pos_dashboard.html"
                                class="flex-1 sm:flex-none px-6 py-3 bg-accent-500 text-white text-center rounded-button font-medium hover:bg-accent-600 transition-micro"
                            >
                                <i class="fas fa-arrow-left mr-2"></i>Volver al Dashboard
                            </a>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Rate History -->
            <div class="mt-8 bg-white rounded-lg shadow-card border border-border">
                <div class="p-6 border-b border-border">
                    <h3 class="text-lg font-semibold text-text-primary mb-2">Historial de Cambios</h3>
                    <p class="text-text-secondary">Últimas actualizaciones de tasas de cambio</p>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Fecha</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Moneda</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Tasa Anterior</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Tasa Nueva</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Cambio</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Usuario</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-border">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">22/10/2025 01:45</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <span class="text-warning-600 font-bold mr-2">Bs</span>
                                        <span class="text-sm text-text-primary">Bolívares</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">Bs 44.80</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">Bs 45.50</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">
                                        <i class="fas fa-arrow-up mr-1"></i>+1.56%
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary">Admin</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">21/10/2025 14:30</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <span class="text-accent-600 font-bold mr-2">$</span>
                                        <span class="text-sm text-text-primary">Pesos COP</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">$4,180</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">$4,250</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">
                                        <i class="fas fa-arrow-up mr-1"></i>+1.67%
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary">Admin</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">20/10/2025 09:15</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <span class="text-warning-600 font-bold mr-2">Bs</span>
                                        <span class="text-sm text-text-primary">Bolívares</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">Bs 45.20</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-data">Bs 44.80</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-error-100 text-error-800">
                                        <i class="fas fa-arrow-down mr-1"></i>-0.88%
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary">Admin</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-floating animate-scale-in">
            <div class="text-center">
                <div class="w-16 h-16 bg-success-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-check text-success-600 text-2xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-text-primary mb-2">¡Tasas Actualizadas!</h3>
                <p class="text-text-secondary mb-6">Las tasas de cambio se han actualizado correctamente y están activas en el sistema.</p>
                <button onclick="closeSuccessModal()" class="w-full bg-primary-500 text-white py-3 rounded-button font-medium hover:bg-primary-600 transition-micro">
                    Continuar
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let originalRates = {
            bs: 45.50,
            cop: 4250
        };

        let currentRates = {
            bs: 45.50,
            cop: 4250
        };

        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Validate inputs and update preview
        function validateAndPreview() {
            const bsInput = document.getElementById('bsRate');
            const copInput = document.getElementById('copRate');
            const bsValidation = document.getElementById('bsValidation');
            const bsError = document.getElementById('bsError');
            const copValidation = document.getElementById('copValidation');
            const copError = document.getElementById('copError');

            // Validate Bs rate
            const bsValue = parseFloat(bsInput.value);
            const bsValid = bsValue > 0 && bsValue <= 999999.99;
            
            if (bsValid) {
                bsValidation.classList.remove('hidden');
                bsError.classList.add('hidden');
                bsInput.classList.remove('border-error-500');
                bsInput.classList.add('border-success-500');
                currentRates.bs = bsValue;
            } else {
                bsValidation.classList.add('hidden');
                bsError.classList.remove('hidden');
                bsInput.classList.remove('border-success-500');
                bsInput.classList.add('border-error-500');
            }

            // Validate COP rate
            const copValue = parseFloat(copInput.value);
            const copValid = copValue > 0 && copValue <= 999999;
            
            if (copValid) {
                copValidation.classList.remove('hidden');
                copError.classList.add('hidden');
                copInput.classList.remove('border-error-500');
                copInput.classList.add('border-success-500');
                currentRates.cop = copValue;
            } else {
                copValidation.classList.add('hidden');
                copError.classList.remove('hidden');
                copInput.classList.remove('border-success-500');
                copInput.classList.add('border-error-500');
            }

            // Update preview if both rates are valid
            if (bsValid && copValid) {
                updatePreview();
                enableSaveButton();
            } else {
                disableSaveButton();
            }
        }

        // Update price preview
        function updatePreview() {
            // Pizza Whankoos 440 (P) - $8.50
            document.getElementById('previewBs').textContent = `Bs ${(8.50 * currentRates.bs).toFixed(2)}`;
            document.getElementById('previewCop').textContent = `$${(8.50 * currentRates.cop).toFixed(0)} COP`;

            // Coca Cola - $2.50
            document.getElementById('previewBsCola').textContent = `Bs ${(2.50 * currentRates.bs).toFixed(2)}`;
            document.getElementById('previewCopCola').textContent = `$${(2.50 * currentRates.cop).toFixed(0)} COP`;

            // Gyro - $6.50
            document.getElementById('previewBsGyro').textContent = `Bs ${(6.50 * currentRates.bs).toFixed(2)}`;
            document.getElementById('previewCopGyro').textContent = `$${(6.50 * currentRates.cop).toFixed(0)} COP`;
        }

        // Enable save button
        function enableSaveButton() {
            const saveButton = document.getElementById('saveButton');
            saveButton.disabled = false;
            saveButton.classList.remove('opacity-50', 'cursor-not-allowed');
        }

        // Disable save button
        function disableSaveButton() {
            const saveButton = document.getElementById('saveButton');
            saveButton.disabled = true;
            saveButton.classList.add('opacity-50', 'cursor-not-allowed');
        }

        // Reset to default rates
        function resetToDefaults() {
            document.getElementById('bsRate').value = 45.50;
            document.getElementById('copRate').value = 4250;
            currentRates = { bs: 45.50, cop: 4250 };
            validateAndPreview();
        }

        // Cancel changes
        function cancelChanges() {
            document.getElementById('bsRate').value = originalRates.bs;
            document.getElementById('copRate').value = originalRates.cop;
            currentRates = { ...originalRates };
            validateAndPreview();
        }

        // Handle form submission
        document.getElementById('exchangeRateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const saveButton = document.getElementById('saveButton');
            const saveButtonText = document.getElementById('saveButtonText');
            
            // Show loading state
            saveButton.disabled = true;
            saveButtonText.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Guardando...';
            
            // Simulate API call
            setTimeout(() => {
                // Update original rates
                originalRates = { ...currentRates };
                
                // Update current rate displays
                document.getElementById('currentBsRate').textContent = `Bs ${currentRates.bs.toFixed(2)}`;
                document.getElementById('currentCopRate').textContent = `$${currentRates.cop.toFixed(0)}`;
                
                // Update last update time
                const now = new Date();
                const timeString = now.toLocaleString('es-ES', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                document.getElementById('lastUpdate').textContent = timeString;
                
                // Save to localStorage
                localStorage.setItem('whankoos_exchange_rates', JSON.stringify({
                    rates: currentRates,
                    lastUpdate: timeString
                }));
                
                // Reset button state
                saveButton.disabled = false;
                saveButtonText.innerHTML = '<i class="fas fa-save mr-2"></i>Guardar Cambios';
                
                // Show success modal
                showSuccessModal();
                
            }, 1500);
        });

        // Show success modal
        function showSuccessModal() {
            const modal = document.getElementById('successModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close success modal
        function closeSuccessModal() {
            const modal = document.getElementById('successModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Load saved rates on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedData = localStorage.getItem('whankoos_exchange_rates');
            if (savedData) {
                const data = JSON.parse(savedData);
                originalRates = data.rates;
                currentRates = { ...data.rates };
                
                // Update form inputs
                document.getElementById('bsRate').value = currentRates.bs;
                document.getElementById('copRate').value = currentRates.cop;
                
                // Update displays
                document.getElementById('currentBsRate').textContent = `Bs ${currentRates.bs.toFixed(2)}`;
                document.getElementById('currentCopRate').textContent = `$${currentRates.cop.toFixed(0)}`;
                document.getElementById('lastUpdate').textContent = data.lastUpdate;
                
                // Validate and update preview
                validateAndPreview();
            } else {
                // Initialize with default values
                validateAndPreview();
            }
        });

        // Close modal when clicking outside
        document.getElementById('successModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSuccessModal();
            }
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>